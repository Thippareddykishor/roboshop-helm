# {{ if .Values.ingress.enabled }}

# apiVersion: networking.k8s.io/v1
# kind: Ingress
# metadata:
#     name: {{ .Values.component_name }}
#     namespace: default
#     # annontations:
# spec:
#     IngressController: nginx
#     rules:
#     - host: {{ .Values.ingress_name }}
#       http:
#         paths: 
#         - path: /
#           pathType: Prefix
#           backend: 
#             service: 
#                 name: {{ .Values.component_name }}
#                 port:  
#                     number: {{ .Values.service.port }}
# {{ end }}

{{ if .Values.ingress.enabled }}
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: {{ .Values.component_name }}
  annotations:
    nginx.ingress.kubernetes.io/force-ssl-redirect: "true"

#     cert-manager.io/cluster-issuer: letsencrypt
spec:
  ingressClassName: nginx
  tls:
  - hosts:
    - {{ .Values.ingress.name }}
    secretName: {{ .Values.component_name }}-tls
  rules:
  - host: {{ .Values.ingress.name }}
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: {{ .Values.component_name }}
            port:
              number: {{ .Values.service.port }}

{{ end }}
